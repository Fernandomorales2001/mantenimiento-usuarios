<div class="row" [hidden]="ocultarTodo">
    <div class="col-12 mb-3" >
         <div #map class="mapa" ></div> 
    </div> 
</div>
<div class="row" *ngIf="talleresSeleccionados.length > 0">
    <div class="col-12">

        <div class="row  mb-3 ml-1 mr-1">
            <div class="col-12">
                <div class="row">
                    <div class="col-12 card-primary">
                        <div class="row">
                            <div class="col-12 text-center franja text-white"> <h6>Lista de clientes</h6> </div>
                        </div>
    
                        <div class="row mt-3">
                            <div class="col-12 tabla-principal">

                                <div class="row mb-1">
                                    <div class="col-4">
                                        <input class="form-control" type="text" 
                                        placeholder="Ingrese texto para filtrar "
                                        #textBusqueda
                                        placeholder="Ingrese una descripcion para filtrar"
                                        (keyup)="textBuscar= textBusqueda.value" 
                                        >
                                    </div>
                                    <div class="div-2">
                                        <button type="button" class="btn btn-success btn-sm"    (click)="exportar()">
                                            <span>Exportar <i class="far fa-file-excel"></i>
                                            </span> 
                                        </button>
                                    </div>
                                </div>

                                <table class="table table-sm " id="tablaTalleres" #tablaTalleres>
                                    <thead>
                                        <tr>
                                            <th>
                                                <div class="row">
                                                    <div class="col-1"></div>
                                                    <div class="col-3 hover" (click)="order(1)">
                                                        Cliente 
                                                        <span *ngIf="ordenamientoPorTaller"> <i class="fas fa-sort-down" ></i> </span>
                                                        <span *ngIf="!ordenamientoPorTaller"> <i class="fas fa-caret-up"></i> </span>
                                                    </div>
                                                    <div class="col-1 hover" (click)="order(2)" >
                                                        Fecha
                                                        <span *ngIf="ordenamientoPorFecha"> <i class="fas fa-sort-down" ></i> </span>
                                                        <span *ngIf="!ordenamientoPorFecha"> <i class="fas fa-caret-up"></i> </span>
                                                    </div>
                                                    <div class="col-2 hover" (click)="order(3)" >
                                                        Nombre Contacto
                                                        <span *ngIf="ordenamientoPorMecanico"> <i class="fas fa-sort-down" ></i> </span>
                                                        <span *ngIf="!ordenamientoPorMecanico"> <i class="fas fa-caret-up"></i> </span>
                                                    </div>
                                                    <div class="col-2">Telefono</div>
                                                    <div class="col-1">Mec Pro.</div>
                                                    <div class="col-1">Mec Apre.</div>
                                                    <div class="col-1">Verificar</div>
                                                </div> 
                                            </th>
                                        </tr>
                                    </thead>
                                    <tbody>
    
                                        <tr 
                                        class="hover col" *ngFor="let taller of talleresSeleccionados | filter: textBuscar" 
                                        >
                                        <div  class="row m-1 font-primary"
                                        
                                        >
                                            <div class="col-1">
                                                <button
                                                (click)="quitarTallerSeleccionado(taller)"
                                                type="button" class="btn btn-delete btn-sm">
                                                    <span >
                                                        <i class="far fa-window-close"></i>
                                                    </span>
                                                </button>
                                            </div>
                                            <div class="col-3 " (click)="expandir(taller)">{{taller.nombretaller}}</div>
                                            <div class="col-1" (click)="expandir(taller)">{{taller.fecha | date:'dd/MM/yyyy' }}</div>
                                            <div class="col-2" (click)="expandir(taller)">{{taller.nombreMecanico}}</div>
                                            <div class="col-2 " (click)="expandir(taller)">{{taller.telefono}}</div>
                                            <div class="col-1" (click)="expandir(taller)">{{taller.mecPro}}</div>
                                            <div class="col-1" (click)="expandir(taller)">{{taller.mecApre}}</div>
                                            <!-- <div class="col-1"> 
                                                <button type="button" class="btn btn-primary btn-sm" (click)="expandir(taller)">
                                                    <i class="fas fa-arrow-right"  *ngIf="!taller.expandir"></i> 
                                                    <i class="fas fa-arrow-down" *ngIf="taller.expandir"></i>
                                                </button>
                                            </div> -->
                                            <div class="col-1"> 
                                                <button type="button" class="btn btn-primary btn-sm" (click)="verificar(taller)">
                                                    <span *ngIf="!taller.verificar">
                                                        Verificar
                                                        <i class="far fa-circle" ></i>
                                                    </span>
                                                    <span *ngIf="taller.verificar"> 
                                                        Verificado <i class="far fa-check-circle" ></i>
                                                    </span>
                                                </button>
                                            </div>
                                        </div>
    
                                        <div *ngIf="taller.expandir" class="separador-top row separador-bottom contenido-taller">
                                            <div  class="col-12 "   >
                                                    
                                                    <div class="row text-strong"  >
                                                        <div class="col-6">
                                                            Direccion: {{taller.direccion_calle1}} 
                                                        </div>
                                                        <div class="col-4">Fecha registrado: {{taller.fecha_hora_creado | date: 'dd/MM/yyyy' }}</div>
                                                        <div class="col-2 text-center">
                                                            <button 
                                                            (click)="imagenes = taller.galeria"
                                                            data-toggle="modal"
                                                            data-target="#exampleModal"
                                                            type="button" class="btn btn-primary btn-sm">VER GALERIA</button></div>
                                                    </div>

                                                    <div class="row text-strong">
                                                        <div class="col-4"> 
                                                            Telefono: 
                                                            <div class="d-inline p-2" *ngFor="let telefono of taller.telefonos">({{telefono.area}}){{telefono.telefono}}</div>      
                                                        </div>
                                                        <div class="col-3"> 
                                                            Dias Laborales: 
                                                            <ng-container *ngFor="let dia of taller.horarios">
                                                                <div class="d-inline p-1" *ngIf="dia.abierto" >{{dia.dia}}</div>      
                                                            </ng-container>
                                                        </div>
                                                        <div class="col-4">
                                                            Correo: {{taller.correo}}
                                                        </div>
                                                    </div>

                                                    <div class="row text-strong">
                                                        <div class="col-4">
                                                            RTN: {{taller.rtn}}
                                                        </div>
                                                        <div class="col-4">
                                                            Ciudad: {{taller.descripcion_ciudad}}
                                                        </div>
                                                    </div>
                                                   
                                                        <div class="row text-strong">
                                                            <div class="col-lg-3 col-xs-12 col-md-4" *ngFor="let mecanico of taller.mecanicos">
                                                                <div class="card no-margin" >
                                                                    <div class="card-body">
                                                                        <div class="row">
                                                                            <div class="col-3 image-box">
                                                                                <img [src]="mecanico.url_imagen" 
                                                                                data-toggle="modal"
                                                                                data-target="#exampleModalMecanico"
                                                                                (click)="imagenMecanico = mecanico.url_imagen" class="imagen-mecanico imagen" >
                                                                            </div>
                                                                            <div class="col-9">
                                                                                <h6 class= "card-title"><small><strong>{{mecanico.nombres}} {{mecanico.apellido1}} {{mecanico.apellido2}}</strong> </small> </h6>                               
                                                                                <h6 class="card-subtitle text-muted"> <small>{{mecanico.cedula}}</small></h6>
                                                                            </div>
                                                                        </div>
                                                                        <p class="font-primary no-margin">Fecha nacimiento: {{mecanico.fecha_nacimiento | date:'dd/MM/yyyy'}}</p>
                                                                        <p class="font-primary no-margin">Telefono: {{mecanico.telefono_movil}}</p>
                                                                        <p class="font-primary no-margin">Email: {{mecanico.correo_electronico}}</p>
                                                                        <p class="font-primary no-margin">Direccion: {{mecanico.barrio_colonia_digitado}}</p>
                                                                        <p class="font-primary no-margin">Tarjeta lealtad <br>
                                                                            <button type="button" class="btn btn-primary btn-sm" [ngClass]="{'cerrado': !mecanico.tarjeta_entregada}" *ngIf="!mecanico.tarjeta_entregada">NO</button> 
                                                                         <button type="button" class="btn btn-primary btn-sm" *ngIf="mecanico.tarjeta_entregada">SI</button> 
                                                                        </p>
                                                                        
                                                                    </div>
                                                                  </div>
                                                            </div>
                                                              
                                                        </div>
                                                        <br>
                                                    
                                            </div>
                                        </div>
    
                                        </tr>
                                        
                                    </tbody>
                                    </table>
                            </div>
                        </div>
                    </div>
                </div>
    
    
            </div>
        </div>
    </div>        
</div>


<div class="row"  >
    <div class="col-lg-3 col-xs-3 col-md-4 VerTalleres hover" 
    
    >
        <span 
        (click)="mostrarListaTalleresVerficados = !mostrarListaTalleresVerficados"
        *ngIf="!mostrarListaTalleresVerficados">MOSTRAR CLIENTES</span>
        <span 
        (click)="mostrarListaTalleresVerficados = !mostrarListaTalleresVerficados"
        *ngIf="mostrarListaTalleresVerficados">OCULTAR CLIENTES</span>

        <div class="chat-popup" id="myForm" *ngIf="mostrarListaTalleresVerficados">
            <div  class="form-container">



                <div class="row" *ngFor="let taller of talleresSeleccionados">
                    <div class="col-12  listado" *ngIf="taller.verificar">
                        <div class="d-inline text-strong">
                            {{taller.nombretaller}}
                                <button
                                (click)="verificar(taller)"
                                style="float: right;"
                                type="button" class="btn btn-delete btn-sm">
                                    <span >
                                        <i class="far fa-window-close"></i>
                                    </span>
                                </button>
                        </div>
                    </div>
                </div>

                <div class="row bg-success"  *ngIf="hayTalleresVerificados">
                    <div class="col-12  listado" (click)="mandarActualizarTalleres()">
                        <div class="d-inline  text-white">
                            VERIFICAR ESTOS CLIENTES
                                <button
                                style="float: right;"
                                type="button" class="btn btn-success btn-sm">
                                    <span >
                                        <i class="fas fa-check"></i> 
                                    </span>
                                </button>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>
</div>

<!-- Modal IMAGEN-->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-imagen" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">IMAGENES</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div id="carouselExampleIndicator" class="carousel slide mb-3" data-ride="carousel">
            <div class="carousel-inner" >
                <div class="carousel-item"  *ngFor="let img of imagenes ; let id= index"  [ngClass]="{'active': id==0}">
                    <img class="img-fluid d-flex justify-content-center text-center" [src]="img.url_foto"  >
                </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleIndicator" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleIndicator" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal IMAGEN-->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-imagen" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLabel">IMAGENES</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div id="carouselExampleIndicator" class="carousel slide mb-3" data-ride="carousel">
            <div class="carousel-inner" >
                <div class="carousel-item"  *ngFor="let img of imagenes ; let id= index"  [ngClass]="{'active': id==0}">
                    <img class="img-fluid d-flex justify-content-center text-center" [src]="img.url_foto"  >
                </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleIndicator" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleIndicator" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal IMAGEN-->
<div class="modal fade" id="exampleModalMecanico" tabindex="-1" role="dialog" aria-labelledby="exampleModalMecanico" aria-hidden="true">
    <div class="modal-dialog modal-imagen" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalMecanicoLabel">IMAGENES</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
        <div class="modal-body">
          <div id="carouselExampleIndicator" class="carousel slide mb-3" data-ride="carousel">
            <div class="carousel-inner" >
                <div class="carousel-item active" >
                    <img class="img-fluid d-flex justify-content-center text-center" [src]="imagenMecanico"  >
                </div>
            </div>
            <a class="carousel-control-prev" href="#carouselExampleIndicator" role="button" data-slide="prev">
              <span class="carousel-control-prev-icon" aria-hidden="true"></span>
              <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#carouselExampleIndicator" role="button" data-slide="next">
              <span class="carousel-control-next-icon" aria-hidden="true"></span>
              <span class="sr-only">Next</span>
            </a>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>